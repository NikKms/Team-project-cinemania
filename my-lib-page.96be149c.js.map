{"mappings":"imBAAA,IAAAA,EAAAC,EAAA,S,qEAOA,MAAMC,EAAO,CACXC,UAAWC,SAASC,cAAc,qBAClCC,WAAYF,SAASC,cAAc,sBACnCE,SAAUH,SAASC,cAAc,gBACjCG,eAAgBJ,SAASC,cAAc,eACvCI,YAAa,MAwBf,SAASC,IACPC,OAAOC,oBAAoB,UAAWC,GAErBF,OAAOG,SAASC,KACjBC,SAAS,qBACvBhB,EAAAiB,OAAOC,SAASC,QAGlBf,SAASgB,KAAKC,UAAUC,OAAO,mBAC/BpB,EAAKK,SAASc,UAAUE,IAAI,Y,CAS9B,SAASV,EAAcW,GACF,WAAfA,EAAMC,MAAmBf,G,CAxC/BN,SAASsB,iBAAiB,SAI1B,SAAqBF,GACnB,MAAMG,EAASH,EAAMI,OAAOC,QAAQ,UACpC,GAAe,OAAXF,EAAiB,QAqCvBG,eAA4BC,IAK5BD,eAAiCE,GAC/BC,QAAQC,IAAIF,GACZ,MAAMG,YACJA,EAAWC,cACXA,EAAaC,OACbA,EAAMC,SACNA,EAAQC,WACRA,EAAUC,MACVA,EAAKC,aACLA,EAAYC,WACZA,EAAUX,GACVA,GACEC,EAEJC,QAAQC,IAAI,gBAAiBC,GAC7B,MAAMQ,EAAgBN,EAAOO,KAAIC,GAASA,EAAMd,KAC1Ce,QAAuB,EAAAC,EAAAC,gBAAeL,GAE5C,IAAIM,EAAY,GAEdA,EADkB,OAAhBd,EACU,uCAAuCA,IACxB,OAAlBC,EACG,uCAAuCA,IAGjD,yEAGJ,MAAMc,EAAS,uFAIFD,8GAKwBT,2NAKjBC,EAAaU,QACnB,qBACkBT,gRAOjBH,EAAWY,QAAQ,+NAMcL,iKAKPR,qPAGoEP,gEAM7G7B,EAAKM,eAAe4C,UAAYF,EAEhChD,EAAKO,YAAcL,SAASiD,eAAe,oBAC3CpB,QAAQC,IAAI,gBAAiBhC,EAAKO,aAElC,MAAM6C,EAAWC,KACf,EAAAC,EAAAC,kBAAiBzB,EAAK,EAGxB9B,EAAKO,YAAYiB,iBAAiB,QAAS4B,E,CAnF3CI,OADmB,EAAAC,EAAAC,gBAAe7B,G,EAnClC8B,CADelC,EAAOmC,QAAQ/B,IAGbpB,OAAOG,SAASC,KACjBC,SAAS,qBACvBhB,EAAAiB,OAAOC,SAAS6C,OAGlB3D,SAASgB,KAAKC,UAAUE,IAAI,mBAC5BZ,OAAOe,iBAAiB,UAAWb,GACnCX,EAAKK,SAASc,UAAUC,OAAO,Y,IAjBjCpB,EAAKI,WAAWoB,iBAAiB,QAAShB,GAC1CR,EAAKK,SAASmB,iBAAiB,SA+B/B,SAAyBF,GACnBA,EAAMwC,gBAAkBxC,EAAMI,QAChClB,G,4MClDJ,IAAAuD,EAAAhE,EAAA,SACA,MAAMiE,EAAiBC,KAAKC,MAAMC,aAAaC,QAAQ,WAAa,GAE9DC,EAAmB,EAACpC,YACxBA,EAAWK,MACXA,EAAKgC,KACLA,EAAIC,eACJA,EAAcC,aACdA,EAAYjC,aACZA,EAAYV,GACZA,EAAEM,OACFA,EAAMsC,UACNA,MAEA,MAAMC,EACJvC,GAAUA,EAAOwC,OAAS,EAAIxC,EAAOO,KAAIC,GAASA,EAAMd,KAAM4C,EAIhE,IAFqBT,EAAeY,MAAKC,GAASA,EAAMhD,KAAOA,IAkB7D,OAfAmC,EAAec,QAAQ,C,YACrB7C,E,MACAK,E,KACAgC,E,eACAC,E,aACAC,E,aACAjC,E,GACAV,E,UACA6C,IAEFP,aAAaY,QAAQ,QAASd,KAAKe,UAAUhB,SAC7CD,EAAAkB,OAAOC,QACL,gCACA,qCAIJnB,EAAAkB,OAAOE,QACL,mBACA,6DACD,EAaGC,EATiB,MACrB,IACE,MAAMC,EAAWlB,aAAaC,QAAQ,SACtC,OAAOH,KAAKC,MAAMmB,IAAa,E,CAC/B,MAAOC,GACPvD,QAAQuD,MAAMA,E,GAIEC,GAEdC,EAAsB,IACvB,IAAIC,IAAIL,EAAYM,SAAQ5D,GAAQA,EAAK4C,cAG9C3C,QAAQC,IAAI,wBAAyBwD,E,2FC3DrC,IAAA/B,EAAA1D,EAAA,SAEA6B,eAAe+D,EAAeC,GAC5B,MACMzD,SADa,EAAAsB,EAAAoC,aACC1D,OAMpB,OAJkByD,EAAIlD,KAAIb,IACxB,MAAMiE,EAAQ3D,EAAO4D,MAAKpD,GAASA,EAAMd,KAAOA,IAChD,OAAOiE,EAAQA,EAAMxB,KAAO,EAAE,IAEf0B,KAAK,K","sources":["src/partials/js/modal.js","src/partials/js/my-lib/lib-storage.js","src/partials/js/my-lib/example-my-lib.js"],"sourcesContent":["import { swiper } from '../../partials/js/hero/hero';\nimport { getInfoByMovie } from './api';\nimport { getGenre } from './api';\nimport { addFilmToStorage } from './my-lib/lib-storage';\nimport { onWatchTrailer } from './hero/trailer-modal';\nimport { getGenresByIds } from './my-lib/example-my-lib';\n\nconst refs = {\n  openModal: document.querySelector('[data-modal-open]'),\n  closeModal: document.querySelector('[data-modal-close]'),\n  backdrop: document.querySelector('[data-modal]'),\n  upcomingWrapLi: document.querySelector('.modal-info'),\n  addToLibBtn: null,\n};\n\ndocument.addEventListener('click', onOpenModal);\nrefs.closeModal.addEventListener('click', onCloseModal);\nrefs.backdrop.addEventListener('click', onBackdropClick);\n\nfunction onOpenModal(event) {\n  const cardEl = event.target.closest('.is-id');\n  if (cardEl === null) return;\n\n  const cardId = cardEl.dataset.id;\n  getMovieById(cardId);\n\n  let currentUrl = window.location.href;\n  if (!currentUrl.includes('my-lib-page.html')) {\n    swiper.autoplay.stop();\n  }\n\n  document.body.classList.add('not-scroll-body');\n  window.addEventListener('keydown', onEscKeyPress);\n  refs.backdrop.classList.remove('is-hidden');\n}\n\nfunction onCloseModal() {\n  window.removeEventListener('keydown', onEscKeyPress);\n\n  let currentUrl = window.location.href;\n  if (!currentUrl.includes('my-lib-page.html')) {\n    swiper.autoplay.start();\n  }\n\n  document.body.classList.remove('not-scroll-body');\n  refs.backdrop.classList.add('is-hidden');\n}\n\nfunction onBackdropClick(event) {\n  if (event.currentTarget === event.target) {\n    onCloseModal();\n  }\n}\n\nfunction onEscKeyPress(event) {\n  if (event.code === 'Escape') onCloseModal();\n}\n\nasync function getMovieById(id) {\n  const data = await getInfoByMovie(id);\n  renderFilmInModal(data);\n}\n\nasync function renderFilmInModal(film) {\n  console.log(film);\n  const {\n    poster_path,\n    backdrop_path,\n    genres,\n    overview,\n    popularity,\n    title,\n    vote_average,\n    vote_count,\n    id,\n  } = film;\n  \n  console.log('poster_path: ', poster_path);\n  const genresListIds = genres.map(genre => genre.id);\n  const formatedGenres = await getGenresByIds(genresListIds);\n\n  let imagePath = '';\n  if (poster_path !== null) {\n    imagePath = `https://image.tmdb.org/t/p/original/${poster_path}`;\n  } else if (backdrop_path !== null) {\n    imagePath = `https://image.tmdb.org/t/p/original/${backdrop_path}`;\n  } else {\n    imagePath =\n      'https://d2ths1nqi4sbhh.cloudfront.net/images/no-image.png?v=3884857787';\n  }\n\n  const markup = `\n    <div class=\"modal-card\">\n      <img\n        class=\"modal-img\"\n        src=\"${imagePath}\"\n        alt=\" \"\n      />\n\n      <div class=\"modal-card-wrap\">\n        <h3 class=\"modal-card-title\">${title}</h3>\n\n          <div class=\"modal-card-vote-wrap\">\n            <div class=\"modal-card-vote color-description\"><span>Vote / Votes</span></div>\n            <div class=\"modal-card-vote-data\">\n              <span>${vote_average.toFixed(\n                1\n              )}</span> / <span>${vote_count}</span>\n            </div>\n          </div>\n        \n          <div class=\"modal-card-popularity-wrap\">\n            <span class=\"modal-card-popularity-text color-description\">Popularity</span>\n            <span class=\"modal-card-popularity-data\"\n              >${popularity.toFixed(1)}</span\n            >\n          </div>\n\n          <div class=\"modal-card-genre-wrap\">\n            <span class=\"modal-card-genre-text color-description\">Genre</span>\n            <span class=\"modal-card-genre-data\">${formatedGenres}</span>\n          </div>\n        \n        <span class=\"modal-card-about-title color-description\">About</span>\n\n        <p class=\"modal-card-about-text\">${overview}</p>\n\n        <button class=\"modal-button gap-right\" id=\"add-to-lib-modal\" type=\"button\"><span>Add to my library</span></button>\n         <button type=\"button\" class=\"hero-btn modal-button hero-btn-trailer\" id=\"hero-btn-trailer\" data-id=\"${id}\">\n    Watch trailer\n  </button>\n      </div>\n    </div>`;\n\n  refs.upcomingWrapLi.innerHTML = markup;\n\n  refs.addToLibBtn = document.getElementById('add-to-lib-modal');\n  console.log('addToLibBtn: ', refs.addToLibBtn);\n\n  const addToLib = evt => {\n    addFilmToStorage(film);\n  };\n\n  refs.addToLibBtn.addEventListener('click', addToLib);\n}\n\nexport { refs };\n","import { Report } from 'notiflix';\nconst localMoviesArr = JSON.parse(localStorage.getItem('films')) || [];\n\nconst addFilmToStorage = ({\n  poster_path,\n  title,\n  name,\n  first_air_date,\n  release_date,\n  vote_average,\n  id,\n  genres,\n  genre_ids,\n}) => {\n  const genresIds =\n    genres && genres.length > 0 ? genres.map(genre => genre.id) : genre_ids;\n\n  const isFilmExists = localMoviesArr.some(movie => movie.id === id);\n\n  if (!isFilmExists) {\n    localMoviesArr.unshift({\n      poster_path,\n      title,\n      name,\n      first_air_date,\n      release_date,\n      vote_average,\n      id,\n      genresIds,\n    });\n    localStorage.setItem('films', JSON.stringify(localMoviesArr));\n    Report.success(\n      'Film was added to the library',\n      'Go to the library and check it :)'\n    );\n    return;\n  }\n  Report.failure(\n    'Is added already',\n    \"Sorry, but you've already added this film to your library \"\n  );\n  // removeItemFromLocalStorage(film.id);\n};\n\nconst getParsedFilms = () => {\n  try {\n    const filmsArr = localStorage.getItem('films');\n    return JSON.parse(filmsArr) || [];\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nconst parsedFilms = getParsedFilms();\n\nconst parsedFilmsGenreIds = [\n  ...new Set(parsedFilms.flatMap(film => film.genresIds)),\n];\n\nconsole.log('parsedFilmsGenreIds: ', parsedFilmsGenreIds);\n\nexport { parsedFilms, parsedFilmsGenreIds, addFilmToStorage };\n","import { getGenre } from '../api';\n\nasync function getGenresByIds(ids) {\n  const data = await getGenre();\n  const genres = data.genres;\n\n  const arrGenres = ids.map(id => {\n    const genre = genres.find(genre => genre.id === id);\n    return genre ? genre.name : '';\n  });\n  return arrGenres.join(', ');\n}\n\nexport { getGenresByIds };\n"],"names":["$g7hbw","parcelRequire","$51a648048b126082$export$21666b427502ea6d","openModal","document","querySelector","closeModal","backdrop","upcomingWrapLi","addToLibBtn","$51a648048b126082$var$onCloseModal","window","removeEventListener","$51a648048b126082$var$onEscKeyPress","location","href","includes","swiper","autoplay","start","body","classList","remove","add","event","code","addEventListener","cardEl","target","closest","async","id","film","console","log","poster_path","backdrop_path","genres","overview","popularity","title","vote_average","vote_count","genresListIds","map","genre","formatedGenres","$2qgck","getGenresByIds","imagePath","markup","toFixed","innerHTML","getElementById","addToLib","evt","$cl7Eh","addFilmToStorage","$51a648048b126082$var$renderFilmInModal","$19F3f","getInfoByMovie","$51a648048b126082$var$getMovieById","dataset","stop","currentTarget","$7Y9D8","$8fbd6111e242142d$var$localMoviesArr","JSON","parse","localStorage","getItem","$8fbd6111e242142d$export$d326f28fa561aa06","name","first_air_date","release_date","genre_ids","genresIds","length","some","movie","unshift","setItem","stringify","Report","success","failure","$8fbd6111e242142d$export$c118d883ed694a49","filmsArr","error","$8fbd6111e242142d$var$getParsedFilms","$8fbd6111e242142d$export$c149f286d6cc84b6","Set","flatMap","$1c3a9307ddc15aad$export$f426a0af08472714","ids","getGenre","genre1","find","join"],"version":3,"file":"my-lib-page.96be149c.js.map"}