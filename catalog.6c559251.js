function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},n={},s=t.parcelRequire8a95;null==s&&((s=function(e){if(e in a)return a[e].exports;if(e in n){var t=n[e];delete n[e];var s={id:e,exports:{}};return a[e]=s,t.call(s.exports,s,s.exports),s.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){n[e]=t},t.parcelRequire8a95=s),s("g7hbw");var i={};Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a;return e};const r={pagination:document.getElementById("pagination"),catalogFilms:document.querySelector(".catalog-films"),searchForm:document.querySelector(".search-form"),selectGenres:document.querySelector("#selectGenres"),selectDate:document.querySelector("#selectDate"),btnClear:document.querySelector(".search-clear-btn"),input:document.getElementById("search-form"),btnSearch:document.querySelector(".search-btn")},o=e=>{const t=document.querySelector(".no-movie-found");null!==t&&t.remove();const a=e.map((e=>`<li data-id="${e.id}" class="catalog-card is-id">\n  <img\n    src="https://image.tmdb.org/t/p/original${e.poster}"\n    alt="${e.title}"\n    loading="lazy"\n  />\n  <div class="catalog-overlay"></div>\n  <div class="catalog-info">\n    <h3 class="catalog-info-name">${e.title}</h3>\n    <div class="catalog-info-date">\n      <p class="catalog-info-details">${e.genres} | ${e.date}</p>\n      <div\n        class="Stars stars-five"\n        style="--rating: ${e.rating}"\n        aria-label="Rating of this product is 2.3 out of 5."\n      ></div>\n    </div>\n  </div>\n</li>`)).join("");if(!a.length){const e=l();return console.log(e),r.catalogFilms.insertAdjacentHTML("beforebegin",e),void(r.catalogFilms.innerHTML="")}var n;n=a,r.catalogFilms.innerHTML=n},l=()=>'<div class="no-movie-found">\n    <p class="no-movie-found__text">\n      <span class="no-movie-found__text-item">OOPS...</span>\n      <span class="no-movie-found__text-item">We are very sorry!</span>\n      <span class="no-movie-found__text-item">\n        We donâ€™t have any results matching your search.\n      </span>\n    </p>\n  </div>';const c=async e=>{const t=await w(),a=e.map((({id:e,title:a,poster_path:n,vote_average:s,genre_ids:i,release_date:r})=>({id:e,title:a,poster:n,rating:s,genres:d(t,i),date:g(r)})));o(a)},d=(e,t)=>{const a=[];return e.map((({id:e,name:n})=>{-1!==t.indexOf(e)&&a.push(n)})),a.slice(0,2).join(", ")},g=e=>new Date(e).getFullYear(),u=(e,t)=>{try{const a=JSON.stringify(t);localStorage.setItem(e,a)}catch(e){console.error("Set state error: ",e.message)}},h=e=>{try{const t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(e){console.error("Get state error: ",e.message)}};class p{updatePage(e){this.currentPage=e,this.createButton()}constructor(t,a,n,s=[]){e(i)(this,"createButton",(async()=>{if(console.log(this.params),this.totalPages<=1)return void this.reset();this.arrPaginationItems=[],this.addFirstPages(this.arrPaginationItems),this.totalPages>6&&(this.addEllipsisIfNeeded(this.arrPaginationItems),this.addMiddlePages(this.arrPaginationItems),this.addEllipsisIfNeeded(this.arrPaginationItems,!0),this.addLastPage(this.arrPaginationItems));const e=this.createPagination(this.arrPaginationItems.join(""));this.render(e),u("currentPage",this.currentPage)})),e(i)(this,"addFirstPages",(e=>{for(let t=1;t<=Math.min(3,this.totalPages);t++){const a=this.currentPage===t?"btn-active":"",n=this.createPaginationItem("0"+t,a);e.push(n)}})),e(i)(this,"addMiddlePages",(e=>{const t=Math.max(4,this.currentPage-2),a=Math.min(this.currentPage+1,this.totalPages-1);for(let n=t;n<=a;n++){const t=this.currentPage===n?"btn-active":"";let a=[];a=n<=9?this.createPaginationItem("0"+n,t):this.createPaginationItem(n,t),e.push(a)}})),e(i)(this,"addEllipsisIfNeeded",((e,t=!1)=>{(t&&this.currentPage<this.totalPages-2||!t&&this.currentPage>3)&&e.push('<li class="pagination-item ellipsis">...</li>')})),e(i)(this,"addLastPage",(e=>{const t=this.totalPages,a=this.currentPage===t?"btn-active":"",n=this.createPaginationItem(t,a);e.push(n)})),e(i)(this,"createPaginationItem",((e,t)=>`<li class='pagination-item ${t}'>\n              <a href='#' data-page='${e}' class='pagination-btn'>${e}</a>\n            </li>`)),e(i)(this,"createPagination",(e=>`\n      <div class='pagination ${this.totalPages<=1?"pagination-hidden":""}'>\n      <button type="button" class='pagination-arrow pagination-arrows-prev${this.totalPages<=1?"pagination-arrows-hidden":""}'>prev</button>\n        <ul class='pagination-list'>${e}</ul>\n        <button type="button" class='pagination-arrow pagination-arrows-next${this.totalPages<=1?"pagination-arrows-hidden":""}'>next</button>\n      </div>`)),e(i)(this,"render",(e=>{this.reset(),r.catalogFilms.insertAdjacentHTML("afterend",e);const t=document.querySelector(".pagination"),a=document.querySelector(".pagination");t.addEventListener("click",this.handlerBtn),a.addEventListener("click",this.arrowHandler);const n=document.querySelector(".pagination-arrow.pagination-arrows-prev");1===this.currentPage?n.style.display="none":n.style.display="block";const s=document.querySelector(".pagination-arrow.pagination-arrows-next");this.currentPage===this.totalPages?s.style.display="none":s.style.display="block"})),e(i)(this,"arrowHandler",(e=>{const t=e.target;t.classList.contains("pagination-arrows-prev")&&this.prev(),t.classList.contains("pagination-arrows-next")&&this.next()})),e(i)(this,"reset",(()=>{const e=document.querySelector(".pagination");e&&e.remove()})),e(i)(this,"prev",(()=>{if(1===this.currentPage)return;this.currentPage-=1,this.createButton();const e=document.querySelector(".pagination-arrow.pagination-arrows-prev");1===this.currentPage?e.style.display="none":e.style.display="block"})),e(i)(this,"next",(()=>{if(this.currentPage===this.totalPages)return;this.currentPage+=1,this.createButton();const e=document.querySelector(".pagination-arrow.pagination-arrows-next");this.currentPage===this.totalPages?e.style.display="none":e.style.display="block"})),e(i)(this,"handlerBtn",(async e=>{e.preventDefault();const t=parseInt(e.target.dataset.page);isNaN(t)||(this.currentPage=t,this.createButton(),await this.getMovies(this.currentPage,...this.params))})),console.log(s),this.totalPages=t,this.currentPage=a,this.getMovies=n,this.params=s,this.arrPaginationItems=[]}}var m=s("19F3f"),v=s("2shzp"),y=s("kHmXk");const f=async(e,t=1,a="")=>{r.selectGenres.disabled=!0,r.selectDate.disabled=!1,console.log(e,t,a);const{results:n,total_pages:s,page:i}=await(0,m.getByQuery)(e,t,a);return c(n),{results:n,total_pages:s,page:i}},P=async(e,t=0)=>{r.selectGenres.disabled=!1,r.selectDate.disabled=!0;const{data:a}=await async function(e){try{(0,y.onLoader)();const t=await v.default.get(e);return(0,y.removeLoader)(),t}catch(e){return console.log(e),(0,y.removeLoader)(),null}}(`https://api.themoviedb.org/3/movie/now_playing?api_key=88b8a7c5d221d3120fb29d734050dc7d&page=${e}${t?`&with_genres=${t}`:""}&language=en-US`);console.log(a);const{results:n,page:s,total_pages:i}=a;return console.log(n),c(n),{results:n,page:s,total_pages:i}},w=async()=>{const{data:e}=await v.default.get("https://api.themoviedb.org/3/genre/movie/list?api_key=88b8a7c5d221d3120fb29d734050dc7d"),{genres:t}=e;return t},b=document.querySelector(".search-form"),_=document.querySelector("#selectGenres"),S=document.querySelector("#selectDate"),L=async()=>{const{page:e,total_pages:t}=await P(1);new p(t,e,P).createButton()},I=async e=>{const t=h("searchTerm");console.log("afterSearching",t);const{page:a,total_pages:n}=await f(1,t);new p(n,a,f,[t,1]).createButton(),S.removeAttribute("disabled")};b.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData(e.target),{searchMovies:a}=Object.fromEntries(t.entries());a.length?(u("searchTerm",a),I(a)):L()})),window.addEventListener("load",L),window.addEventListener("load",(async()=>{let e=(await w()).map((e=>`<option value="${e.id}">${e.name}</option>`));e.unshift("<option value='all'>All</option>"),_.innerHTML=e.join(""),_.removeAttribute("disabled")})),window.addEventListener("load",(()=>{const e=[];for(let t=(new Date).getFullYear();t>=1970;t--)e.push(`<option value="${t}">${t}</option>`);S.innerHTML=e.join("")})),_.addEventListener("change",(async e=>{const t=e.target.value,{total_pages:a,results:n}=await P(1,e.target.value);new p(a,1,P,[t]).createButton()})),S.addEventListener("change",(async e=>{const t=e.target.value,a=h("searchTerm"),{total_pages:n,page:s}=await f(1,a,t);new p(n,1,f,[a,t]).createButton()})),s("g7hbw"),s("70ClL"),s("7Yg6P"),s("2tESM"),r.btnClear.addEventListener("click",(()=>{console.log("hi"),r.input.value=""})),s("hwTRf");
//# sourceMappingURL=catalog.6c559251.js.map
