function t(t){return t&&t.__esModule?t.default:t}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},s={},n=e.parcelRequire8a95;null==n&&((n=function(t){if(t in a)return a[t].exports;if(t in s){var e=s[t];delete s[t];var n={id:t,exports:{}};return a[t]=n,e.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){s[t]=e},e.parcelRequire8a95=n),n("g7hbw");var i={};Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a;return t};const r={pagination:document.getElementById("pagination"),catalogFilms:document.querySelector(".catalog-films")},o=t=>{const e=t.map((t=>`<div data-id=${t.id} class="catalog-card">\n      <img src='https://image.tmdb.org/t/p/original${t.poster}' alt="${t.title}" loading="lazy" />\n      <div class="catalog-info">\n        <div>\n          <p class="catalog-info-name">\n            <b>${t.title}</b>\n          </p>\n          <p class="catalog-info-details">\n            <span>${t.genres}</span>\n            <span class="catalog-info-border" >${t.date}</span>\n          </p>\n        </div>\n        <div\n          class="Stars"\n          style="--rating: ${t.rating/2}"\n          aria-label="Rating of this product is 2.3 out of 5."\n        ></div>\n      </div>\n    </div>`)).join("");var a;a=e,r.catalogFilms.innerHTML=a};const l=async t=>{const e=await P(),a=t.map((({id:t,title:a,poster_path:s,vote_average:n,genre_ids:i,release_date:r})=>({id:t,title:a,poster:s,rating:n,genres:c(e,i),date:d(r)})));o(a)},c=(t,e)=>{const a=[];return t.map((({id:t,name:s})=>{-1!==e.indexOf(t)&&a.push(s)})),a.join(",")},d=t=>new Date(t).getFullYear(),g=(t,e)=>{try{const a=JSON.stringify(e);localStorage.setItem(t,a)}catch(t){console.error("Set state error: ",t.message)}},u=t=>{try{const e=localStorage.getItem(t);return null===e?void 0:JSON.parse(e)}catch(t){console.error("Get state error: ",t.message)}};class h{constructor(e,a,s){t(i)(this,"createButton",(()=>{const t=[];this.addFirstPages(t),this.totalPages>3&&this.addEllipsisIfNeeded(t),this.totalPages>3&&this.addMiddlePages(t),this.totalPages>3&&this.addEllipsisIfNeeded(t,!0),this.totalPages>3&&this.addLastPage(t);const e=this.createPagination(t.join(""));this.render(e),g("currentPage",this.currentPage),this.getMovies(this.currentPage)})),t(i)(this,"addFirstPages",(t=>{for(let e=1;e<=Math.min(3,this.totalPages);e++){const a=this.currentPage===e?"btn-active":"",s=this.createPaginationItem(e,a);t.push(s)}})),t(i)(this,"addMiddlePages",(t=>{const e=Math.max(4,this.currentPage-2),a=Math.min(this.currentPage+1,this.totalPages-1);for(let s=e;s<=a;s++){const e=this.currentPage===s?"btn-active":"",a=this.createPaginationItem(s,e);t.push(a)}})),t(i)(this,"addEllipsisIfNeeded",((t,e=!1)=>{(e&&this.currentPage<this.totalPages-2||!e&&this.currentPage>3)&&t.push('<li class="pagination-item">...</li>')})),t(i)(this,"addLastPage",(t=>{const e=this.totalPages,a=this.currentPage===e?"btn-active":"",s=this.createPaginationItem(e,a);t.push(s)})),t(i)(this,"createPaginationItem",((t,e)=>`<li class='pagination-item ${e}'>\n              <a href='#' data-page='${t}' class='pagination-btn'>${t}</a>\n            </li>`)),t(i)(this,"createPagination",(t=>`<ul class='pagination'>${t}</ul>`)),t(i)(this,"render",(t=>{this.reset(),r.catalogFilms.insertAdjacentHTML("afterend",t);document.querySelector(".pagination").addEventListener("click",this.handlerBtn)})),t(i)(this,"reset",(()=>{const t=document.querySelector(".pagination");t&&t.remove()})),t(i)(this,"handlerBtn",(t=>{t.preventDefault();const e=parseInt(t.target.dataset.page);isNaN(e)||(this.currentPage=e,this.createButton())})),this.totalPages=e,this.currentPage=a,this.getMovies=s}}var p=n("19F3f"),f=n("2shzp");const m=async(t=1)=>{const e=u("searchTerm");console.log(t,e);const{results:a,total_pages:s,page:n}=await(0,p.getByQuery)(e,t);return l(a),{results:a,total_pages:s,page:n}},v=async t=>{const{data:e}=await f.default.get(`https://api.themoviedb.org/3/movie/now_playing?api_key=88b8a7c5d221d3120fb29d734050dc7d&page=${t}&language=en-US`),{results:a,page:s,total_pages:n}=e;return l(a),{results:a,page:s,total_pages:n}},P=async()=>{const{data:t}=await f.default.get("https://api.themoviedb.org/3/genre/movie/list?api_key=88b8a7c5d221d3120fb29d734050dc7d"),{genres:e}=t;return e},b=document.querySelector(".search-form"),y=async()=>{const{page:t,total_pages:e}=await v();new h(e,t,v).createButton()},w=async t=>{const{page:e,total_pages:a}=await m();new h(a,e,m).createButton()};b.addEventListener("submit",(t=>{t.preventDefault();const e=new FormData(t.target),{searchMovies:a}=Object.fromEntries(e.entries());a.length?(g("searchTerm",a),w(a)):y()})),window.addEventListener("load",y),n("7Yg6P"),n("2tESM");
//# sourceMappingURL=catalog.a2a1e3cb.js.map
